<!doctype html>
<html lang="de" class="h-full">
 <head>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#6366f1">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>habitus</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;family=Poppins:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
    }
    
    * {
      font-family: 'Inter', sans-serif;
    }
    
    .card {
      backdrop-filter: blur(10px);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .card:hover {
      transform: translateY(-2px);
    }
    
    .btn {
      transition: all 0.2s ease;
    }
    
    .btn:hover:not(:disabled) {
      transform: scale(1.02);
    }
    
    .btn:active:not(:disabled) {
      transform: scale(0.98);
    }
    
    .modal-overlay {
      animation: fadeIn 0.2s ease;
    }
    
    .modal-content {
      animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .progress-bar {
      transition: width 0.5s ease;
    }
    
    .streak-glow {
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }
    
    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: #6366f1;
    }
    
    ::-webkit-scrollbar {
      width: 6px;
    }
    
    ::-webkit-scrollbar-track {
      background: transparent;
    }
    
    ::-webkit-scrollbar-thumb {
      background: rgba(255,255,255,0.1);
      border-radius: 3px;
    }
    
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }
    
    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    
    .nav-btn {
      position: relative;
      transition: all 0.2s ease;
    }
    
    .nav-btn.active {
      background: rgba(99, 102, 241, 0.2);
    }
    
    .nav-btn.active::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 30px;
      height: 3px;
      background: #6366f1;
      border-radius: 3px 3px 0 0;
    }
    
    .page {
      animation: fadeInPage 0.4s ease;
    }
    
    @keyframes fadeInPage {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .icon-btn svg {
      color: currentColor;
    }

.plus-menu-item {
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
}

#plus-icon-svg {
  transition: transform 0.3s ease;
}
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full" style="background: #000000;">
<div id="app" class="h-full w-full overflow-auto"><!-- Header -->
   <header class="sticky top-0 z-40" style="background: rgba(15, 15, 15, 0.95); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255, 255, 255, 0.05);">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 py-3 sm:py-4">
     <h1 id="app-title" class="text-xl sm:text-2xl font-bold" style="color: #ffffff; font-family: 'Poppins', sans-serif;">habitus.</h1>
     <p id="date-display" class="text-xs sm:text-sm mt-1" style="color: #6b7280;"></p>
    </div>
   </header><!-- Navigation -->
   <nav class="fixed bottom-6 left-1/2 -translate-x-1/2 w-[95%] max-w-lg bg-black/40 rounded-[2.5rem] p-1.5 border border-white/10 backdrop-blur-md z-50">
  <ul class="flex items-center justify-between relative" id="bottom-nav">
    
    <li class="flex-1">
      <button onclick="navigateToPage('stats')" id="nav-stats" class="nav-item w-full flex flex-col items-center justify-center gap-1 py-3 rounded-[2rem] transition-all active:scale-95 text-white bg-white/10">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
        <span class="text-[10px] font-bold uppercase tracking-tight">Dashboard</span>
      </button>
    </li>

    <li class="flex-1">
      <button onclick="navigateToPage('todos')" id="nav-todos" class="nav-item w-full flex flex-col items-center justify-center gap-1 py-3 rounded-[2rem] text-gray-400 hover:text-white transition-all active:scale-95">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="m9 12 2 2 4-4"/></svg>
        <span class="text-[10px] font-medium uppercase tracking-tight">Todos</span>
      </button>
    </li>

    <li class="px-2">
  <button id="main-plus-btn" onclick="togglePlusMenu()" class="bg-white text-black h-12 w-12 flex items-center justify-center rounded-full shadow-lg hover:scale-105 active:scale-90 transition-all">
    <svg id="plus-icon-svg" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" style="transition: transform 0.3s ease;">
      <line x1="12" y1="5" x2="12" y2="19"></line>
      <line x1="5" y1="12" x2="19" y2="12"></line>
    </svg>
  </button>
</li>

    <li class="flex-1">
      <button onclick="navigateToPage('habits')" id="nav-habits" class="nav-item w-full flex flex-col items-center justify-center gap-1 py-3 rounded-[2rem] text-gray-400 hover:text-white transition-all active:scale-95">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 3h12"/><path d="M6 21h12"/><path d="M7 11h10"/><path d="M7 3v18"/><path d="M17 3v18"/></svg>
        <span class="text-[10px] font-medium uppercase tracking-tight">Habits</span>
      </button>
    </li>

    <li class="flex-1">
      <button onclick="navigateToPage('sport')" id="nav-sport" class="nav-item w-full flex flex-col items-center justify-center gap-1 py-3 rounded-[2rem] text-gray-400 hover:text-white transition-all active:scale-95">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.4 14.4 9.6 9.6"/><path d="M18.657 21.485a2 2 0 1 1-2.829-2.828l-1.767 1.768a2 2 0 1 1-2.829-2.829l6.364-6.364a2 2 0 1 1 2.829 2.829l-1.768 1.767a2 2 0 1 1 2.828 2.829z"/><path d="m21.5 21.5-1.4-1.4"/><path d="M3.9 3.9 2.5 2.5"/><path d="M6.404 12.768a2 2 0 1 1-2.829-2.829l1.768-1.767a2 2 0 1 1-2.828-2.829l2.828-2.828a2 2 0 1 1 2.829 2.828l1.767-1.768a2 2 0 1 1 2.829 2.829z"/></svg>
        <span class="text-[10px] font-medium uppercase tracking-tight">Sport</span>
      </button>
    </li>

  </ul>
   </nav><main id="stats-page" class="page px-4 py-4 pb-28">
  <div class="max-w-4xl mx-auto w-full space-y-4">
    
    <div class="grid grid-cols-3 gap-3">
      <div class="card p-4 rounded-[2rem] flex flex-col items-center justify-center bg-white/5 border border-white/10">
        <div class="relative w-full aspect-square flex items-center justify-center">
          <svg viewBox="0 0 100 100" class="w-full h-full transform -rotate-90">
            <circle cx="50" cy="50" r="40" fill="none" stroke="currentColor" stroke-width="8" class="text-white/10" />
            <circle id="day-progress-arc-mobile" cx="50" cy="50" r="40" fill="none" stroke="#6366f1" stroke-width="8" stroke-linecap="round" stroke-dasharray="251.2" stroke-dashoffset="251.2" style="transition: stroke-dashoffset 0.8s ease;" />
          </svg>
          <span id="day-progress-text" class="absolute text-base font-bold text-indigo-500">0%</span>
        </div>
        <p class="text-[10px] uppercase tracking-wider font-bold mt-2 text-gray-400">Heute</p>
      </div>

      <div class="card p-4 rounded-[2rem] flex flex-col items-center justify-center bg-white/5 border border-white/10">
        <div class="relative w-full aspect-square flex items-center justify-center">
          <svg viewBox="0 0 100 100" class="w-full h-full transform -rotate-90">
            <circle cx="50" cy="50" r="40" fill="none" stroke="currentColor" stroke-width="8" class="text-white/10" />
            <circle id="week-progress-arc-mobile" cx="50" cy="50" r="40" fill="none" stroke="#22c55e" stroke-width="8" stroke-linecap="round" stroke-dasharray="251.2" stroke-dashoffset="251.2" style="transition: stroke-dashoffset 0.8s ease;" />
          </svg>
          <span id="week-progress-text" class="absolute text-base font-bold text-green-500">0%</span>
        </div>
        <p class="text-[10px] uppercase tracking-wider font-bold mt-2 text-gray-400">Woche</p>
      </div>

      <div class="card p-4 rounded-[2rem] flex flex-col items-center justify-center bg-white/5 border border-white/10">
        <div class="relative w-full aspect-square flex items-center justify-center">
          <svg viewBox="0 0 100 100" class="w-full h-full transform -rotate-90">
            <circle cx="50" cy="50" r="40" fill="none" stroke="currentColor" stroke-width="8" class="text-white/10" />
            <circle id="month-progress-arc-mobile" cx="50" cy="50" r="40" fill="none" stroke="#fb923c" stroke-width="8" stroke-linecap="round" stroke-dasharray="251.2" stroke-dashoffset="251.2" style="transition: stroke-dashoffset 0.8s ease;" />
          </svg>
          <span id="month-progress-text" class="absolute text-base font-bold text-orange-400">0%</span>
        </div>
        <p class="text-[10px] uppercase tracking-wider font-bold mt-2 text-gray-400">Monat</p>
      </div>
    </div>

    <div class="grid grid-cols-2 gap-3">
      <div class="card p-5 rounded-[2rem] bg-gradient-to-br from-orange-500/10 to-transparent border border-orange-500/20 cursor-pointer hover:scale-105 transition-transform active:scale-95" onclick="openStreakDetails()">
        <div id="dashboard-total-streak">
          <div class="flex items-center gap-2 mb-3">
            <div class="p-2 rounded-xl bg-orange-500/20 text-orange-500">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg>
            </div>
            <span class="text-[10px] font-bold text-gray-500 uppercase tracking-widest">Streak</span>
          </div>
          <div class="flex items-baseline gap-1">
            <span id="stat-streak" class="text-3xl font-bold text-orange-500">0</span>
            <span class="text-xs text-orange-500/60 font-semibold">Tage</span>
          </div>
        </div>
      </div>

      <div class="card p-5 rounded-[2rem] bg-gradient-to-br from-green-500/10 to-transparent border border-green-500/20">
        <div class="flex items-center gap-2 mb-3">
          <div class="p-2 rounded-xl bg-green-500/20 text-green-500">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg>
          </div>
          <span class="text-[10px] font-bold text-gray-500 uppercase tracking-widest">Heute</span>
        </div>
        <div class="flex items-baseline gap-1">
          <span id="stat-today" class="text-3xl font-bold text-green-500">0/0</span>
          <span class="text-xs text-green-500/60 font-semibold">Habits</span>
        </div>
      </div>

      <div class="card p-5 rounded-[2rem] bg-white/5 border border-white/10">
        <div class="flex items-center gap-2 mb-3 text-purple-400">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><line x1="19" y1="8" x2="19" y2="14"/><line x1="22" y1="11" x2="16" y2="11"/></svg>
          <span class="text-[10px] font-bold text-gray-500 uppercase tracking-widest">Aktiv</span>
        </div>
        <span id="stat-active-habits" class="text-3xl font-bold text-white">0</span>
      </div>

      <div class="card p-5 rounded-[2rem] bg-white/5 border border-white/10">
        <div class="flex items-center gap-2 mb-3 text-pink-400">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/><path d="m9 11 3 3L22 4"/></svg>
          <span class="text-[10px] font-bold text-gray-500 uppercase tracking-widest">Offen</span>
        </div>
        <span id="stat-open-todos" class="text-3xl font-bold text-white">0</span>
      </div>
    </div>
  </div>
</main><!-- Habits Page -->

<!-- Streak Details Page -->
<main id="streak-details-page" class="page px-3 sm:px-6 py-6 sm:py-8 pb-24 sm:pb-32 hidden">
  <div class="max-w-4xl mx-auto">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-xl font-bold text-white">üî• Streak Details</h2>
      <button onclick="navigateToPage('stats')" class="p-2 bg-white/10 rounded-xl text-white hover:bg-white/20 transition-all">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
    <div id="streak-details-content"></div>
  </div>
</main>
   <main id="habits-page" class="page px-3 sm:px-6 py-6 sm:py-8 pb-24 sm:pb-32 hidden">
    <div class="max-w-4xl mx-auto">
     <div class="flex items-center justify-between mb-4 sm:mb-6">
      <h2 class="text-lg sm:text-xl font-bold" style="color: #e5e7eb;">Meine Habits</h2><button class="btn px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-semibold text-white text-sm" style="background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);" onclick="openHabitModal()"> + Neuer Habit </button>
     </div><!-- Week Picker for Habits -->
     <div class="mb-4 sm:mb-6 overflow-hidden rounded-xl" style="background: rgba(30, 30, 30, 0.5); border: 1px solid rgba(255, 255, 255, 0.05);">
      <div id="habits-week-slider" class="overflow-x-auto no-scrollbar touch-pan-x" style="scroll-behavior: smooth; -webkit-overflow-scrolling: touch;">
       <div class="flex gap-1 p-2 min-w-max"><!-- Week days will be inserted here -->
       </div>
      </div>
     </div>
     <div id="habits-container" class="space-y-2 sm:space-y-3"><!-- Habits werden hier eingef√ºgt -->
     </div>
     <div id="empty-habits" class="text-center py-16 sm:py-20 hidden">
      <div class="w-16 sm:w-20 h-16 sm:h-20 rounded-3xl mx-auto mb-4 sm:mb-6 flex items-center justify-center" style="background: rgba(99, 102, 241, 0.1);">
       <svg width="32" height="32" viewbox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sm:w-10 sm:h-10"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />
       </svg>
      </div>
      <p id="empty-habits-message" class="text-base sm:text-lg font-medium mb-2" style="color: #9ca3af;">Erstelle deinen ersten Habit</p>
      <p class="text-xs sm:text-sm" style="color: #6b7280;">Starte mit einem neuen Habit und baue gesunde Routinen auf</p>
     </div>
    </div>
   </main><!-- Todos Page -->
   <main id="todos-page" class="page px-3 sm:px-6 py-6 sm:py-8 pb-24 sm:pb-32 hidden">
    <div class="max-w-4xl mx-auto">
     <div class="flex items-center justify-between mb-4 sm:mb-6">
      <h2 class="text-lg sm:text-xl font-bold" style="color: #e5e7eb;">Meine Aufgaben</h2><button class="btn px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-semibold text-white text-sm" style="background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);" onclick="openTodoModal()"> + Neue Aufgabe </button>
     </div><!-- Week Picker for Todos -->
     <div class="mb-4 sm:mb-6 overflow-hidden rounded-xl" style="background: rgba(30, 30, 30, 0.5); border: 1px solid rgba(255, 255, 255, 0.05);">
      <div id="todos-week-slider" class="overflow-x-auto no-scrollbar touch-pan-x" style="scroll-behavior: smooth; -webkit-overflow-scrolling: touch;">
       <div class="flex gap-1 p-2 min-w-max"><!-- Week days will be inserted here -->
       </div>
      </div>
     </div>
     <div id="todos-container" class="space-y-2 sm:space-y-3"><!-- Todos werden hier eingef√ºgt -->
     </div>
     <div id="empty-todos" class="text-center py-16 sm:py-20 hidden">
      <div class="w-16 sm:w-20 h-16 sm:h-20 rounded-3xl mx-auto mb-4 sm:mb-6 flex items-center justify-center" style="background: rgba(34, 197, 94, 0.1);">
       <svg width="32" height="32" viewbox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sm:w-10 sm:h-10"><path d="M9 11l3 3L22 4" /> <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11" />
       </svg>
      </div>
      <p id="empty-todos-message" class="text-base sm:text-lg font-medium mb-2" style="color: #9ca3af;">Erstelle deine erste Aufgabe</p>
      <p class="text-xs sm:text-sm" style="color: #6b7280;">Organisiere deinen Tag mit Todos</p>
     </div>
    </div>
   </main>
   
   <!-- Sport Page -->
   <main id="sport-page" class="page px-3 sm:px-4 py-4 pb-28 overflow-y-auto" style="display: none;">
     <div class="max-w-4xl mx-auto w-full">
       <div class="mb-4 sm:mb-6 flex justify-center">
         <nav class="inline-flex bg-white/5 rounded-[1.5rem] p-1.5 border border-white/10">
           <button onclick="switchSportTab('workouts')" id="sport-tab-workouts" class="sport-tab px-4 sm:px-6 py-2.5 rounded-[1.2rem] text-[10px] sm:text-xs font-bold uppercase tracking-widest transition-all text-white bg-orange-500">
             Workouts
           </button>
           <button onclick="switchSportTab('history')" id="sport-tab-history" class="sport-tab px-4 sm:px-6 py-2.5 rounded-[1.2rem] text-[10px] sm:text-xs font-bold uppercase tracking-widest transition-all text-gray-500">
             Verlauf
           </button>
           <button onclick="switchSportTab('stats')" id="sport-tab-stats" class="sport-tab px-4 sm:px-6 py-2.5 rounded-[1.2rem] text-[10px] sm:text-xs font-bold uppercase tracking-widest transition-all text-gray-500">
             Stats
           </button>
         </nav>
       </div>

       <div id="sport-view-workouts" class="sport-view-section space-y-4 sm:space-y-6">
         <button onclick="openCreateWorkoutModal()" class="card p-6 sm:p-8 flex items-center justify-center border-dashed border-2 border-white/10 w-full rounded-[2rem] bg-white/5">
           <span class="font-bold text-sm sm:text-lg text-gray-400">+ Workout erstellen</span>
         </button>
         <div id="workout-list" class="space-y-3 sm:space-y-4"></div>
       </div>

       <div id="sport-view-history" class="sport-view-section hidden space-y-3 sm:space-y-4">
         <div id="sport-history-list" class="space-y-3 sm:space-y-4"></div>
       </div>

       <div id="sport-view-stats" class="sport-view-section hidden space-y-4 sm:space-y-6">
         <div class="grid grid-cols-2 gap-3 sm:gap-4">
           <div class="card p-4 sm:p-6 text-center rounded-[2rem] bg-white/5 border border-white/10">
             <p class="text-[10px] text-gray-500 font-bold uppercase mb-1">Heute</p>
             <h2 id="sport-stats-today" class="text-xl sm:text-2xl font-black text-orange-400">‚Äî</h2>
           </div>
           <div class="card p-4 sm:p-6 text-center rounded-[2rem] bg-white/5 border border-white/10">
             <p class="text-[10px] text-gray-500 font-bold uppercase mb-1">Woche</p>
             <h2 id="sport-stats-week" class="text-xl sm:text-2xl font-black text-orange-400">‚Äî</h2>
           </div>
         </div>
       </div>
     </div>
   </main>
   
   <!-- Custom Interval Selector Modal -->
   <div id="interval-selector-modal" class="fixed inset-0 z-[60] hidden">
     <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeIntervalModal()"></div>
     <div class="absolute bottom-0 left-0 right-0 sm:top-1/2 sm:left-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 sm:w-[90%] sm:max-w-sm sm:bottom-auto">
       <div class="bg-gradient-to-b from-gray-900 to-black p-6 rounded-t-3xl sm:rounded-3xl border-t border-white/10 sm:border shadow-2xl">
         <div class="w-12 h-1 rounded-full mx-auto mb-6 bg-white/20 sm:hidden"></div>
         <h3 class="text-lg font-black text-center mb-6 text-white">Wiederholung w√§hlen</h3>
         <div class="space-y-2" id="interval-options">
           <button onclick="selectInterval('daily')" class="w-full p-4 rounded-2xl font-bold text-left bg-white/5 hover:bg-white/10 text-white transition-all">T√§glich</button>
           <button onclick="selectInterval('weekly')" class="w-full p-4 rounded-2xl font-bold text-left bg-white/5 hover:bg-white/10 text-white transition-all">W√∂chentlich</button>
           <button onclick="selectInterval('monthly')" class="w-full p-4 rounded-2xl font-bold text-left bg-white/5 hover:bg-white/10 text-white transition-all">Monatlich</button>
           <button onclick="selectInterval('custom')" class="w-full p-4 rounded-2xl font-bold text-left bg-white/5 hover:bg-white/10 text-white transition-all">Benutzerdefiniert</button>
         </div>
       </div>
     </div>
   </div>

   <!-- Custom Unit Selector Modal -->
   <div id="unit-selector-modal" class="fixed inset-0 z-[60] hidden">
     <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeUnitModal()"></div>
     <div class="absolute bottom-0 left-0 right-0 sm:top-1/2 sm:left-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 sm:w-[90%] sm:max-w-sm sm:bottom-auto">
       <div class="bg-gradient-to-b from-gray-900 to-black p-6 rounded-t-3xl sm:rounded-3xl border-t border-white/10 sm:border shadow-2xl">
         <div class="w-12 h-1 rounded-full mx-auto mb-6 bg-white/20 sm:hidden"></div>
         <h3 class="text-lg font-black text-center mb-6 text-white">Einheit w√§hlen</h3>
         <div class="space-y-2" id="unit-options">
           <button onclick="selectUnit('mal')" class="w-full p-4 rounded-2xl font-bold text-left bg-white/5 hover:bg-white/10 text-white transition-all">√ó (mal)</button>
           <button onclick="selectUnit('min')" class="w-full p-4 rounded-2xl font-bold text-left bg-white/5 hover:bg-white/10 text-white transition-all">Minuten</button>
           <button onclick="selectUnit('std')" class="w-full p-4 rounded-2xl font-bold text-left bg-white/5 hover:bg-white/10 text-white transition-all">Stunden</button>
           <button onclick="selectUnit('seiten')" class="w-full p-4 rounded-2xl font-bold text-left bg-white/5 hover:bg-white/10 text-white transition-all">Seiten</button>
           <button onclick="selectUnit('km')" class="w-full p-4 rounded-2xl font-bold text-left bg-white/5 hover:bg-white/10 text-white transition-all">Kilometer</button>
           <button onclick="selectUnit('liter')" class="w-full p-4 rounded-2xl font-bold text-left bg-white/5 hover:bg-white/10 text-white transition-all">Liter</button>
           <button onclick="selectUnit('stk')" class="w-full p-4 rounded-2xl font-bold text-left bg-white/5 hover:bg-white/10 text-white transition-all">St√ºck</button>
         </div>
       </div>
     </div>
   </div>

   <!-- Custom Date Picker Modal -->
   <div id="date-picker-modal" class="fixed inset-0 z-[60] hidden">
     <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeDatePicker()"></div>
     <div class="absolute bottom-0 left-0 right-0 sm:top-1/2 sm:left-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 sm:w-[90%] sm:max-w-md sm:bottom-auto">
       <div class="bg-gradient-to-b from-gray-900 to-black p-6 rounded-t-3xl sm:rounded-3xl border-t border-white/10 sm:border shadow-2xl">
         <div class="w-12 h-1 rounded-full mx-auto mb-6 bg-white/20 sm:hidden"></div>
         <h3 class="text-lg font-black text-center mb-6 text-white" id="date-picker-title">Datum w√§hlen</h3>
         
         <div class="mb-6">
           <div class="flex items-center justify-between mb-4">
             <button onclick="previousMonth()" class="p-2 rounded-xl bg-white/5 hover:bg-white/10 transition-all">
               <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
             </button>
             <div class="text-white font-bold" id="current-month-year">Januar 2024</div>
             <button onclick="nextMonth()" class="p-2 rounded-xl bg-white/5 hover:bg-white/10 transition-all">
               <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
             </button>
           </div>
           
           <div class="grid grid-cols-7 gap-1 mb-2">
             <div class="text-center text-xs font-bold text-gray-500 py-2">Mo</div>
             <div class="text-center text-xs font-bold text-gray-500 py-2">Di</div>
             <div class="text-center text-xs font-bold text-gray-500 py-2">Mi</div>
             <div class="text-center text-xs font-bold text-gray-500 py-2">Do</div>
             <div class="text-center text-xs font-bold text-gray-500 py-2">Fr</div>
             <div class="text-center text-xs font-bold text-gray-500 py-2">Sa</div>
             <div class="text-center text-xs font-bold text-gray-500 py-2">So</div>
           </div>
           
           <div class="grid grid-cols-7 gap-1" id="calendar-days"></div>
         </div>
         
         <div class="flex gap-3">
           <button onclick="clearDate()" class="flex-1 py-3 rounded-2xl font-bold text-sm bg-white/10 text-gray-300 hover:bg-white/20 transition-all">
             Entfernen
           </button>
           <button onclick="confirmDate()" id="date-picker-confirm-btn" class="flex-1 py-3 rounded-2xl font-bold text-sm bg-indigo-500 text-white hover:bg-indigo-600 transition-all">
             Best√§tigen
           </button>
         </div>
       </div>
     </div>
   </div>
   
   <!-- Habit Modal -->
   <div id="habit-modal" class="fixed inset-0 z-50 hidden">
    <div class="modal-overlay absolute inset-0" style="background: rgba(0,0,0,0.8);" onclick="closeModals()"></div>
    <div class="modal-content absolute bottom-0 left-0 right-0 rounded-t-3xl p-6 max-h-[90%] overflow-auto" style="background: #1a1a1a; border-top: 1px solid rgba(255, 255, 255, 0.1);">
     <div class="w-12 h-1 rounded-full mx-auto mb-6" style="background: rgba(255, 255, 255, 0.1);"></div>
     <h2 id="habit-modal-title" class="text-xl font-bold mb-6" style="color: #e5e7eb;">Neuer Habit</h2><!-- Icon Picker -->
     <div class="mb-5"><label class="text-sm font-medium mb-3 block" style="color: #9ca3af;">Icon</label>
      <div id="habit-icon-picker" class="grid grid-cols-8 gap-2"><!-- Icons werden hier eingef√ºgt -->
      </div>
     </div><!-- Color Picker -->
     <div class="mb-5"><label class="text-sm font-medium mb-3 block" style="color: #9ca3af;">Farbe</label>
      <div id="habit-color-picker" class="grid grid-cols-8 gap-2"><!-- Colors werden hier eingef√ºgt -->
      </div>
     </div><!-- Title -->
     <div class="mb-5"><label for="habit-title" class="text-sm font-medium mb-2 block" style="color: #9ca3af;">Titel</label> <input type="text" id="habit-title" placeholder="z.B. Meditation" maxlength="50" class="w-full px-4 py-3 rounded-xl" style="background: rgba(30, 30, 30, 0.8); border: 1px solid rgba(255, 255, 255, 0.1); color: #e5e7eb;">
     </div><!-- Description -->
     <div class="mb-5"><label for="habit-description" class="text-sm font-medium mb-2 block" style="color: #9ca3af;">Beschreibung (optional)</label> <textarea id="habit-description" placeholder="Details zu deinem Habit..." maxlength="200" rows="2" class="w-full px-4 py-3 rounded-xl resize-none" style="background: rgba(30, 30, 30, 0.8); border: 1px solid rgba(255, 255, 255, 0.1); color: #e5e7eb;"></textarea>
     </div><!-- Habit Type -->
     <div class="mb-5"><label class="text-sm font-medium mb-3 block" style="color: #9ca3af;">Habit Typ</label>
      <div class="grid grid-cols-2 gap-2">
        <button type="button" class="habit-type-chip py-3 rounded-xl font-medium flex items-center justify-center gap-2 bg-white/5 text-gray-400 border border-white/10" data-habit-type="task" onclick="selectHabitType('task')">
          <svg width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg> 
          Aufgabe 
        </button> 
        <button type="button" class="habit-type-chip py-3 rounded-xl font-medium flex items-center justify-center gap-2 bg-white/5 text-gray-400 border border-white/10" data-habit-type="count" onclick="selectHabitType('count')">
          <svg width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="10" y1="6" x2="10" y2="18"></line> <line x1="14" y1="6" x2="14" y2="18"></line> <line x1="6" y1="10" x2="18" y2="10"></line> <line x1="6" y1="14" x2="18" y2="14"></line></svg> 
          Z√§hlen 
        </button> 
        <button type="button" class="habit-type-chip py-3 rounded-xl font-medium flex items-center justify-center gap-2 bg-white/5 text-gray-400 border border-white/10" data-habit-type="time" onclick="selectHabitType('time')">
          <svg width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle> <polyline points="12 6 12 12 16 14"></polyline></svg> 
          Zeit 
        </button>
        <button type="button" class="habit-type-chip py-3 rounded-xl font-medium flex items-center justify-center gap-2 bg-white/5 text-gray-400 border border-white/10" data-habit-type="sport" onclick="selectHabitType('sport')">
          <svg width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg> 
          Sport 
        </button>
      </div>
     </div>
     <!-- Workout Selection (nur f√ºr Sport-Typ) -->
     <div id="habit-workout-section" class="mb-5 hidden">
       <label class="text-sm font-medium mb-3 block" style="color: #9ca3af;">Workout ausw√§hlen</label>
       <button type="button" id="habit-workout-btn" onclick="openWorkoutSelectorModal()" class="w-full px-4 py-3 rounded-xl text-left flex justify-between items-center bg-white/5 border border-white/10 text-white hover:bg-white/10 transition-all">
         <span id="habit-workout-text" class="text-gray-400">Workout w√§hlen...</span>
         <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
       </button>
       <input type="hidden" id="habit-workout-id" value="">
     </div><!-- Interval Type -->
     <div class="mb-5">
       <label class="text-sm font-medium mb-3 block" style="color: #9ca3af;">Wiederholung</label> 
       <button type="button" id="habit-interval-btn" onclick="openIntervalModal()" class="w-full px-4 py-3 rounded-xl text-left flex justify-between items-center bg-white/5 border border-white/10 text-white hover:bg-white/10 transition-all">
         <span id="habit-interval-text">T√§glich</span>
         <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
       </button>
       <input type="hidden" id="habit-interval" value="daily">
     </div><!-- Daily Days Selection -->
     <div id="habit-daily-days" class="mb-5 hidden"><label class="text-sm font-medium mb-3 block" style="color: #9ca3af;">An welchen Tagen?</label>
      <div class="grid grid-cols-7 gap-2"><button type="button" class="daily-day-btn py-3 rounded-xl font-medium text-sm" data-day="1" style="background: rgba(99, 102, 241, 0.2); color: #a5b4fc; border: 2px solid #6366f1;" onclick="toggleDailyDay(1)">Mo</button> <button type="button" class="daily-day-btn py-3 rounded-xl font-medium text-sm" data-day="2" style="background: rgba(99, 102, 241, 0.2); color: #a5b4fc; border: 2px solid #6366f1;" onclick="toggleDailyDay(2)">Di</button> <button type="button" class="daily-day-btn py-3 rounded-xl font-medium text-sm" data-day="3" style="background: rgba(99, 102, 241, 0.2); color: #a5b4fc; border: 2px solid #6366f1;" onclick="toggleDailyDay(3)">Mi</button> <button type="button" class="daily-day-btn py-3 rounded-xl font-medium text-sm" data-day="4" style="background: rgba(99, 102, 241, 0.2); color: #a5b4fc; border: 2px solid #6366f1;" onclick="toggleDailyDay(4)">Do</button> <button type="button" class="daily-day-btn py-3 rounded-xl font-medium text-sm" data-day="5" style="background: rgba(99, 102, 241, 0.2); color: #a5b4fc; border: 2px solid #6366f1;" onclick="toggleDailyDay(5)">Fr</button> <button type="button" class="daily-day-btn py-3 rounded-xl font-medium text-sm" data-day="6" style="background: rgba(99, 102, 241, 0.2); color: #a5b4fc; border: 2px solid #6366f1;" onclick="toggleDailyDay(6)">Sa</button> <button type="button" class="daily-day-btn py-3 rounded-xl font-medium text-sm" data-day="0" style="background: rgba(99, 102, 241, 0.2); color: #a5b4fc; border: 2px solid #6366f1;" onclick="toggleDailyDay(0)">So</button>
      </div>
     </div><!-- Custom Interval -->
     <div id="habit-custom-interval" class="mb-5 hidden"><label class="text-sm font-medium mb-2 block" style="color: #9ca3af;">Alle X Tage</label> <input type="number" id="habit-custom-days" min="2" max="365" value="2" class="w-full px-4 py-3 rounded-xl" style="background: rgba(30, 30, 30, 0.8); border: 1px solid rgba(255, 255, 255, 0.1); color: #e5e7eb;">
     </div><!-- Goal -->
     <div id="habit-goal-section" class="mb-5"><label class="text-sm font-medium mb-2 block" style="color: #9ca3af;">Tagesziel</label>
      <div class="flex gap-3">
        <input type="number" id="habit-goal-value" min="1" max="999" value="1" class="flex-1 px-4 py-3 rounded-xl" style="background: rgba(30, 30, 30, 0.8); border: 1px solid rgba(255, 255, 255, 0.1); color: #e5e7eb;"> 
        <button type="button" id="habit-unit-btn" onclick="openUnitModal()" class="px-4 py-3 rounded-xl flex items-center gap-2 bg-white/5 border border-white/10 text-white hover:bg-white/10 transition-all">
          <span id="habit-unit-text">√ó (mal)</span>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
        </button>
        <input type="hidden" id="habit-goal-unit" value="mal">
      </div>
     </div><!-- End Date -->
     <div class="mb-5">
       <label for="habit-end-date" class="text-sm font-medium mb-2 block" style="color: #9ca3af;">Enddatum (optional)</label> 
       <button type="button" id="habit-end-date-btn" onclick="openDatePicker('habit')" class="w-full px-4 py-3 rounded-xl text-left flex justify-between items-center bg-white/5 border border-white/10 text-gray-400 hover:bg-white/10 transition-all">
         <span id="habit-end-date-text">Kein Enddatum</span>
         <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
       </button>
       <input type="hidden" id="habit-end-date">
     </div><!-- Actions -->
     <div class="flex gap-3"><button id="delete-habit-btn" class="btn flex-1 py-4 rounded-xl font-medium hidden" style="background: rgba(239, 68, 68, 0.2); color: #ef4444; border: 1px solid rgba(239, 68, 68, 0.3);" onclick="confirmDeleteHabit()"> L√∂schen </button> <button id="save-habit-btn" class="btn flex-1 py-4 rounded-xl font-semibold text-white" style="background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);" onclick="saveHabit()"> Speichern </button>
     </div>
    </div>
   </div>
  
  <!-- Habit Delete Confirmation Modal -->
  <div id="habit-delete-modal" class="fixed inset-0 z-[60] hidden">
    <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="cancelDeleteHabit()"></div>
    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[90%] max-w-sm">
      <div class="bg-gradient-to-b from-gray-900 to-black p-6 rounded-3xl border border-red-500/30 shadow-2xl">
        <div class="flex items-center justify-center w-16 h-16 mx-auto mb-4 rounded-full bg-red-500/20">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
          </svg>
        </div>
        <h3 class="text-xl font-black text-center mb-2 text-white">Habit l√∂schen?</h3>
        <p class="text-sm text-center text-gray-400 mb-6">Dieser Habit und alle Fortschritte werden dauerhaft gel√∂scht.</p>
        <div class="flex gap-3">
          <button onclick="cancelDeleteHabit()" class="flex-1 py-3 rounded-2xl font-bold text-sm bg-white/10 text-gray-300 hover:bg-white/20 transition-all">
            Abbrechen
          </button>
          <button onclick="executeDeleteHabit()" class="flex-1 py-3 rounded-2xl font-bold text-sm bg-red-500 text-white hover:bg-red-600 transition-all">
            L√∂schen
          </button>
        </div>
      </div>
    </div>
  </div>
   
   <!-- Workout Selector Modal -->
   <div id="workout-selector-modal" class="fixed inset-0 z-[60] hidden">
     <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeWorkoutSelectorModal()"></div>
     <div class="absolute bottom-0 left-0 right-0 sm:top-1/2 sm:left-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 sm:w-[90%] sm:max-w-md sm:bottom-auto">
       <div class="bg-gradient-to-b from-gray-900 to-black p-6 rounded-t-3xl sm:rounded-3xl border-t border-white/10 sm:border shadow-2xl">
         <div class="w-12 h-1 rounded-full mx-auto mb-6 bg-white/20 sm:hidden"></div>
         <h3 class="text-lg font-black text-center mb-6 text-white">Workout ausw√§hlen</h3>
         <div class="space-y-2 max-h-[60vh] overflow-y-auto" id="workout-selector-list">
           <p class="text-center text-gray-500 py-4">Keine Workouts vorhanden. Erstelle zuerst ein Workout auf der Sport-Seite.</p>
         </div>
       </div>
     </div>
   </div>
   
   <!-- Todo Repeat Selector Modal -->
   <div id="todo-repeat-modal" class="fixed inset-0 z-[60] hidden">
     <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeTodoRepeatModal()"></div>
     <div class="absolute bottom-0 left-0 right-0 sm:top-1/2 sm:left-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 sm:w-[90%] sm:max-w-sm sm:bottom-auto">
       <div class="bg-gradient-to-b from-gray-900 to-black p-6 rounded-t-3xl sm:rounded-3xl border-t border-white/10 sm:border shadow-2xl">
         <div class="w-12 h-1 rounded-full mx-auto mb-6 bg-white/20 sm:hidden"></div>
         <h3 class="text-lg font-black text-center mb-6 text-white">Wiederholung w√§hlen</h3>
         <div class="space-y-2">
           <button onclick="selectTodoRepeat('none')" class="w-full p-4 rounded-2xl font-bold text-left bg-white/5 hover:bg-white/10 text-white transition-all">Keine</button>
           <button onclick="selectTodoRepeat('daily')" class="w-full p-4 rounded-2xl font-bold text-left bg-white/5 hover:bg-white/10 text-white transition-all">T√§glich</button>
           <button onclick="selectTodoRepeat('weekly')" class="w-full p-4 rounded-2xl font-bold text-left bg-white/5 hover:bg-white/10 text-white transition-all">W√∂chentlich</button>
           <button onclick="selectTodoRepeat('monthly')" class="w-full p-4 rounded-2xl font-bold text-left bg-white/5 hover:bg-white/10 text-white transition-all">Monatlich</button>
         </div>
       </div>
     </div>
   </div>
   
   </div><!-- Todo Modal -->
   <div id="todo-modal" class="fixed inset-0 z-50 hidden">
    <div class="modal-overlay absolute inset-0" style="background: rgba(0,0,0,0.8);" onclick="closeModals()"></div>
    <div class="modal-content absolute bottom-0 left-0 right-0 rounded-t-3xl p-6 max-h-[90%] overflow-auto" style="background: #1a1a1a; border-top: 1px solid rgba(255, 255, 255, 0.1);">
     <div class="w-12 h-1 rounded-full mx-auto mb-6" style="background: rgba(255, 255, 255, 0.1);"></div>
     <h2 id="todo-modal-title" class="text-xl font-bold mb-6" style="color: #e5e7eb;">Neue Aufgabe</h2><!-- Title -->
     <div class="mb-5"><label for="todo-title" class="text-sm font-medium mb-2 block" style="color: #9ca3af;">Titel</label> <input type="text" id="todo-title" placeholder="z.B. Einkaufen" maxlength="100" class="w-full px-4 py-3 rounded-xl" style="background: rgba(30, 30, 30, 0.8); border: 1px solid rgba(255, 255, 255, 0.1); color: #e5e7eb;">
     </div><!-- Due Date -->
     <div class="mb-5">
       <label class="text-sm font-medium mb-2 block" style="color: #9ca3af;">F√§lligkeitsdatum</label> 
       <button type="button" id="todo-due-date-btn" onclick="openDatePicker('todo')" class="w-full px-4 py-3 rounded-xl text-left flex justify-between items-center bg-white/5 border border-white/10 text-gray-400 hover:bg-white/10 transition-all">
         <span id="todo-due-date-text">Kein Datum</span>
         <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
       </button>
       <input type="hidden" id="todo-due-date">
     </div><!-- Priority -->
     <div class="mb-5"><label class="text-sm font-medium mb-3 block" style="color: #9ca3af;">Priorit√§t</label>
      <div class="grid grid-cols-3 gap-2"><button type="button" class="priority-chip py-3 rounded-xl font-medium" data-priority="low" style="background: rgba(59, 130, 246, 0.2); color: #60a5fa; border: 1px solid rgba(59, 130, 246, 0.3);" onclick="selectPriority('low')"> Niedrig </button> <button type="button" class="priority-chip py-3 rounded-xl font-medium" data-priority="medium" style="background: rgba(251, 146, 60, 0.2); color: #fb923c; border: 2px solid #fb923c;" onclick="selectPriority('medium')"> Mittel </button> <button type="button" class="priority-chip py-3 rounded-xl font-medium" data-priority="high" style="background: rgba(239, 68, 68, 0.2); color: #ef4444; border: 1px solid rgba(239, 68, 68, 0.3);" onclick="selectPriority('high')"> Hoch </button>
      </div>
     </div><!-- Repeat -->
     <div class="mb-5">
       <label class="text-sm font-medium mb-3 block" style="color: #9ca3af;">Wiederholung</label> 
       <button type="button" id="todo-repeat-btn" onclick="openTodoRepeatModal()" class="w-full px-4 py-3 rounded-xl text-left flex justify-between items-center bg-white/5 border border-white/10 text-white hover:bg-white/10 transition-all">
         <span id="todo-repeat-text">Keine</span>
         <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
       </button>
       <input type="hidden" id="todo-repeat" value="none">
     </div><!-- Actions -->
     <div class="flex gap-3"><button id="delete-todo-btn" class="btn flex-1 py-4 rounded-xl font-medium hidden" style="background: rgba(239, 68, 68, 0.2); color: #ef4444; border: 1px solid rgba(239, 68, 68, 0.3);" onclick="confirmDeleteTodo()"> L√∂schen </button> <button id="save-todo-btn" class="btn flex-1 py-4 rounded-xl font-semibold text-white" style="background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);" onclick="saveTodo()"> Speichern </button>
     </div>
    </div>
   </div>
  
  <!-- Todo Delete Confirmation Modal -->
  <div id="todo-delete-modal" class="fixed inset-0 z-[60] hidden">
    <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="cancelDeleteTodo()"></div>
    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[90%] max-w-sm">
      <div class="bg-gradient-to-b from-gray-900 to-black p-6 rounded-3xl border border-red-500/30 shadow-2xl">
        <div class="flex items-center justify-center w-16 h-16 mx-auto mb-4 rounded-full bg-red-500/20">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
          </svg>
        </div>
        <h3 class="text-xl font-black text-center mb-2 text-white">Todo l√∂schen?</h3>
        <p class="text-sm text-center text-gray-400 mb-6">Diese Aufgabe wird dauerhaft gel√∂scht.</p>
        <div class="flex gap-3">
          <button onclick="cancelDeleteTodo()" class="flex-1 py-3 rounded-2xl font-bold text-sm bg-white/10 text-gray-300 hover:bg-white/20 transition-all">
            Abbrechen
          </button>
          <button onclick="executeDeleteTodo()" class="flex-1 py-3 rounded-2xl font-bold text-sm bg-red-500 text-white hover:bg-red-600 transition-all">
            L√∂schen
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Toast -->
   <div id="toast" class="fixed top-20 left-1/2 -translate-x-1/2 px-6 py-3 rounded-xl text-sm font-medium text-white opacity-0 transition-all duration-300 pointer-events-none shadow-lg" style="background: #22c55e;">
    Gespeichert!
   </div>
<div id="plus-overlay" onclick="togglePlusMenu()" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-40 hidden opacity-0 transition-opacity duration-300"></div>

<div id="plus-menu" class="fixed bottom-28 left-1/2 -translate-x-1/2 z-50 flex flex-col gap-3 pointer-events-none">
  <button onclick="handlePlusSelection('habit')" class="plus-menu-item flex items-center bg-[#6366f1] text-white px-5 py-4 rounded-[1.8rem] shadow-2xl min-w-[190px] active:scale-95 transition-all translate-y-20 opacity-0">
    <div class="bg-white/20 p-2 rounded-xl mr-4">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 3h12"/><path d="M6 21h12"/><path d="M7 11h10"/><path d="M7 3v18"/><path d="M17 3v18"/></svg>
    </div>
    <span class="font-bold text-[11px] uppercase tracking-wider">Neuer Habit</span>
  </button>

  <button onclick="handlePlusSelection('todo')" class="plus-menu-item flex items-center bg-[#22c55e] text-white px-5 py-4 rounded-[1.8rem] shadow-2xl min-w-[190px] active:scale-95 transition-all translate-y-20 opacity-0">
    <div class="bg-white/20 p-2 rounded-xl mr-4">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="m9 12 2 2 4-4"/></svg>
    </div>
    <span class="font-bold text-[11px] uppercase tracking-wider">Neue Aufgabe</span>
  </button>
  
  <button onclick="handlePlusSelection('workout')" class="plus-menu-item flex items-center bg-[#f97316] text-white px-5 py-4 rounded-[1.8rem] shadow-2xl min-w-[190px] active:scale-95 transition-all translate-y-20 opacity-0">
    <div class="bg-white/20 p-2 rounded-xl mr-4">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14.4 14.4 9.6 9.6"/><path d="M18.657 21.485a2 2 0 1 1-2.829-2.828l-1.767 1.768a2 2 0 1 1-2.829-2.829l6.364-6.364a2 2 0 1 1 2.829 2.829l-1.768 1.767a2 2 0 1 1 2.828 2.829z"/><path d="m21.5 21.5-1.4-1.4"/><path d="M3.9 3.9 2.5 2.5"/><path d="M6.404 12.768a2 2 0 1 1-2.829-2.829l1.768-1.767a2 2 0 1 1-2.828-2.829l2.828-2.828a2 2 0 1 1 2.829 2.828l1.767-1.768a2 2 0 1 1 2.829 2.829z"/></svg>
    </div>
    <span class="font-bold text-[11px] uppercase tracking-wider">Neues Workout</span>
  </button>
</div>
  </div>
  
  <!-- Sport Delete Confirmation Modal -->
  <div id="sport-delete-modal" class="fixed inset-0 z-[60] hidden">
    <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeSportDeleteModal()"></div>
    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[90%] max-w-sm">
      <div class="bg-gradient-to-b from-gray-900 to-black p-6 rounded-3xl border border-red-500/30 shadow-2xl">
        <div class="flex items-center justify-center w-16 h-16 mx-auto mb-4 rounded-full bg-red-500/20">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
          </svg>
        </div>
        <h3 class="text-xl font-black text-center mb-2 text-white" id="sport-delete-title">Wirklich l√∂schen?</h3>
        <p class="text-sm text-center text-gray-400 mb-6" id="sport-delete-message">Diese Aktion kann nicht r√ºckg√§ngig gemacht werden.</p>
        <div class="flex gap-3">
          <button onclick="closeSportDeleteModal()" class="flex-1 py-3 rounded-2xl font-bold text-sm bg-white/10 text-gray-300 hover:bg-white/20 transition-all">
            Abbrechen
          </button>
          <button id="sport-delete-confirm-btn" class="flex-1 py-3 rounded-2xl font-bold text-sm bg-red-500 text-white hover:bg-red-600 transition-all">
            L√∂schen
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Sport Type Selector Modal -->
  <div id="sport-type-modal" class="fixed inset-0 z-[60] hidden">
    <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeSportTypeModal()"></div>
    <div class="absolute bottom-0 left-0 right-0 sm:top-1/2 sm:left-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 sm:w-[90%] sm:max-w-sm sm:bottom-auto">
      <div class="bg-gradient-to-b from-gray-900 to-black p-6 rounded-t-3xl sm:rounded-3xl border-t border-white/10 sm:border shadow-2xl">
        <div class="w-12 h-1 rounded-full mx-auto mb-6 bg-white/20 sm:hidden"></div>
        <h3 class="text-lg font-black text-center mb-6 text-white">Block-Typ w√§hlen</h3>
        <div class="space-y-3">
          <button onclick="selectSportType('reps')" class="w-full p-4 rounded-2xl font-bold text-left flex items-center gap-4 bg-blue-500/20 border-2 border-blue-500/50 text-blue-400 hover:bg-blue-500/30 transition-all group">
            <div class="w-12 h-12 rounded-xl bg-blue-500/30 flex items-center justify-center group-hover:scale-110 transition-transform">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <line x1="10" y1="6" x2="10" y2="18"/><line x1="14" y1="6" x2="14" y2="18"/><line x1="6" y1="10" x2="18" y2="10"/><line x1="6" y1="14" x2="18" y2="14"/>
              </svg>
            </div>
            <div>
              <div class="font-black text-lg">Wiederholungen</div>
              <div class="text-xs opacity-70">Z√§hle S√§tze oder Reps</div>
            </div>
          </button>
          
          <button onclick="selectSportType('zeit')" class="w-full p-4 rounded-2xl font-bold text-left flex items-center gap-4 bg-indigo-500/20 border-2 border-indigo-500/50 text-indigo-400 hover:bg-indigo-500/30 transition-all group">
            <div class="w-12 h-12 rounded-xl bg-indigo-500/30 flex items-center justify-center group-hover:scale-110 transition-transform">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>
              </svg>
            </div>
            <div>
              <div class="font-black text-lg">Zeit</div>
              <div class="text-xs opacity-70">Timer f√ºr √úbung</div>
            </div>
          </button>
          
          <button onclick="selectSportType('pause')" class="w-full p-4 rounded-2xl font-bold text-left flex items-center gap-4 bg-orange-500/20 border-2 border-orange-500/50 text-orange-400 hover:bg-orange-500/30 transition-all group">
            <div class="w-12 h-12 rounded-xl bg-orange-500/30 flex items-center justify-center group-hover:scale-110 transition-transform">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/>
              </svg>
            </div>
            <div>
              <div class="font-black text-lg">Pause</div>
              <div class="text-xs opacity-70">Erholungszeit</div>
            </div>
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Sport Player Modal -->
  <div id="sport-player-page" class="fixed inset-0 z-[100] bg-black hidden flex flex-col p-8">
    <div class="flex justify-between items-start mb-12">
      <div>
        <h4 id="player-workout-name" class="text-indigo-500 font-bold text-xs uppercase tracking-[0.2em] mb-1">Workout</h4>
        <h2 id="player-current-block-title" class="text-3xl font-black italic text-white">√úbung</h2>
      </div>
      <button onclick="exitSportPlayer()" class="w-12 h-12 flex items-center justify-center bg-white/10 rounded-full text-2xl font-light">√ó</button>
    </div>

    <div class="flex-1 flex flex-col items-center justify-center text-center">
      <div id="timer-circle" class="relative flex items-center justify-center rounded-full w-64 h-64 mb-8 transition-all duration-500">
        <h3 id="player-main-value" class="text-[8rem] font-black leading-none tabular-nums tracking-tighter text-white">00</h3>
      </div>
      <p id="player-main-unit" class="text-xl font-bold text-gray-300 uppercase tracking-widest">Wdh.</p>
      <p id="player-progress" class="mt-8 text-xs font-bold text-white/30 uppercase tracking-widest">Satz 1 von 5</p>
    </div>

    <div class="mt-auto space-y-4">
      <!-- NEW: Pause Button -->
      <button id="player-pause-btn" onclick="togglePause()" class="w-full px-6 py-3 bg-white/10 rounded-2xl font-bold text-white hover:bg-white/20 transition-all flex items-center justify-center gap-2 hidden">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="6" y="4" width="4" height="16"/>
          <rect x="14" y="4" width="4" height="16"/>
        </svg>
        <span>Pause</span>
      </button>
      
      <button id="player-action-btn" onclick="handlePlayerAction()" class="w-full py-6 bg-white text-black rounded-[2rem] font-black text-2xl active:scale-95 transition-all shadow-2xl">WEITER</button>
      <button onclick="nextSportBlock()" class="w-full py-3 text-gray-500 font-bold text-xs uppercase tracking-widest">√úberspringen</button>
    </div>
  </div>

  <!-- Sport Workout Modal -->
  <div id="sport-workout-modal" class="fixed inset-0 z-50 bg-black/95 backdrop-blur-xl hidden flex items-end sm:items-center justify-center p-0 sm:p-4">
    <div class="card w-full max-w-lg p-4 sm:p-6 flex flex-col max-h-[95vh] sm:max-h-[92vh] rounded-t-[2rem] sm:rounded-[2rem] bg-white/5 border border-white/10">
      <input type="text" id="workout-name" oninput="handleWorkoutNameInput()" placeholder="Workout Titel" class="bg-transparent text-xl sm:text-2xl font-black outline-none border-b border-white/10 pb-2 mb-3 sm:mb-4 text-white">
      <div class="flex items-center gap-2 mb-4 sm:mb-6 bg-white/5 p-2 sm:p-3 rounded-2xl w-fit">
        <input type="checkbox" id="sync-names-check" onchange="syncAllBlockNames()" class="w-4 h-4 accent-indigo-500">
        <label for="sync-names-check" class="text-[9px] sm:text-[10px] font-bold uppercase text-gray-400">Name-Sync</label>
      </div>
      <div class="flex items-center gap-2 mb-4 sm:mb-6 bg-white/5 p-2 sm:p-3 rounded-2xl w-fit">
        <input type="checkbox" id="sets-mode-check" onchange="toggleSetsMode()" class="w-4 h-4 accent-orange-500">
        <label for="sets-mode-check" class="text-[9px] sm:text-[10px] font-bold uppercase text-gray-400">Sets Modus</label>
      </div>
      <div id="blocks-container" class="flex-1 overflow-y-auto space-y-2 sm:space-y-3 no-scrollbar pr-1"></div>
      <div class="mt-4 sm:mt-6 flex flex-wrap gap-2 sm:gap-3 border-t border-white/10 pt-3 sm:pt-4">
        <button onclick="addBlockRow()" class="flex-1 min-w-[100px] bg-white/10 p-3 sm:p-4 rounded-2xl font-bold text-[9px] sm:text-[10px] uppercase text-white">Block +</button>
        <button onclick="saveSportWorkout()" class="flex-1 min-w-[100px] bg-indigo-600 p-3 sm:p-4 rounded-2xl font-bold text-[9px] sm:text-[10px] uppercase text-white">Speichern</button>
        <button id="delete-workout-btn" onclick="deleteWorkout(editingWorkoutId)" class="hidden p-3 sm:p-4 rounded-2xl bg-red-500/10 text-red-500 font-bold text-[9px] sm:text-[10px] uppercase">L√∂schen</button>
        <button onclick="hideSportModal('sport-workout-modal')" class="p-3 sm:p-4 rounded-2xl bg-red-500/10 text-red-500 text-xl">√ó</button>
      </div>
    </div>
  </div>
  
  <link rel="stylesheet" href="styles.css">
  <script src="app.js"></script>
  <script src="streak-system.js"></script>
  <script src="sport.js"></script>
  <script src="custom-modals.js"></script>
  <script src="dynamic-color-override.js"></script>
  <script src="pwa.js"></script>
  <script>

    // --- PLUS BUTTON LOGIC ---
    let isPlusMenuOpen = false;

    function togglePlusMenu() {
      const menu = document.getElementById('plus-menu');
      const overlay = document.getElementById('plus-overlay');
      const items = document.querySelectorAll('.plus-menu-item');
      const plusIcon = document.getElementById('plus-icon-svg');

      isPlusMenuOpen = !isPlusMenuOpen;

      if (isPlusMenuOpen) {
        overlay.classList.remove('hidden');
        menu.classList.remove('pointer-events-none');
        if (plusIcon) plusIcon.style.transform = 'rotate(45deg)';
        
        setTimeout(() => {
          overlay.classList.add('opacity-100');
          items.forEach((item, index) => {
            setTimeout(() => {
              item.classList.remove('translate-y-20', 'opacity-0');
            }, index * 60);
          });
        }, 10);
      } else {
        if (plusIcon) plusIcon.style.transform = 'rotate(0deg)';
        overlay.classList.remove('opacity-100');
        items.forEach(item => item.classList.add('translate-y-20', 'opacity-0'));
        
        setTimeout(() => {
          overlay.classList.add('hidden');
          menu.classList.add('pointer-events-none');
        }, 300);
      }
    }

    function handlePlusSelection(type) {
      togglePlusMenu(); // Men√º erst schlie√üen
      
      if (type === 'habit') {
        if (typeof openHabitModal === 'function') openHabitModal();
      } else if (type === 'todo') {
        if (typeof openTodoModal === 'function') openTodoModal();
      } else if (type === 'workout') {
        if (typeof openCreateWorkoutModal === 'function') openCreateWorkoutModal();
      }
    }
  </script>
 </body>
</html>
